{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Movie Review Website</title>
  <meta name="description" content="">
  <meta name="keywords" content="">

  <!-- Favicons -->
  <link href="{% static 'assets/img/favicon.png' %}" rel="icon">
  <link href="{% static 'assets/img/apple-touch-icon.png' %}" rel="apple-touch-icon">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/aos/aos.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/glightbox/css/glightbox.min.css' %}" rel="stylesheet">
  <link href="{% static 'assets/vendor/swiper/swiper-bundle.min.css' %}" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="{% static 'assets/css/main.css' %}" rel="stylesheet">

  <!-- =======================================================
  * Template Name: TheEvent
  * Template URL: https://bootstrapmade.com/theevent-conference-event-bootstrap-template/
  * Updated: Aug 07 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  <style>
    .logout-icon {
      width: 30px;
      height: 30px;
      cursor: pointer;
      margin-left: 10px;
      transition: transform 0.2s ease;
    }
    
    .logout-icon:hover {
      transform: scale(1.1);
    }
    
  </style>
</head>

<body class="index-page">

  <header id="header" class="header d-flex align-items-center fixed-top">
    <div class="container-fluid container-xl position-relative d-flex align-items-center">

      <a href="index.html" class="logo d-flex align-items-center me-auto">
        <img 
        src="{% static 'assets/img/CriticCircle.png' %}" 
        alt="" 
        style="height: 100px; width: auto; display: block; max-height: 100%;"
      >
      
        <!-- Uncomment the line below if you also wish to use an text logo -->
        <!-- <h1 class="sitename">TheEvent</h1>  -->
      </a>
      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="#hero" class="">Home<br></a></li>
          <li><a href="{% url 'chatroom' %}">Chat Room</a></li>
          {% comment %} <li><a href="#schedule">Schedule</a></li> {% endcomment %}
          <li><a href="{% url 'directors' %}">Directors</a></li>
          <li><a href="{% url 'movies' %}">Movies</a></li>
        
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>

      {% if user.is_authenticated %}
      <!-- If user is authenticated, show the user's name with a profile link -->
      <a class="cta-btn d-none d-sm-block">{{ user }}</a>
      <a href="{% url 'logout' %}">
        <img src="{% static 'logout.png' %}" class="img-fluid logout-icon" alt="Logout" style="width: 20px; height: 20px;">
      </a>

  {% else %}
      <!-- If user is not authenticated, show 'Login' without href -->
      <a class="cta-btn d-none d-sm-block"href="{% url 'login' %}">Login</a>
  {% endif %}

    </div>
  </header>
  <div style="height: 100px; width: 100%;">
    <!-- Your content goes here -->
</div>

  <main class="main">

    <div class="container mt-5">
        <div class="row">
            <div class="col-md-6">
                <img src="{{ movie.image.url }}" alt="{{ movie.title }}" class="img-fluid mb-4" style="width: 1000px; height: 1432px;">
            </div>
            <div class="col-md-6">
                <h2>{{ movie.title }}</h2>
                <p><strong>Release Year:</strong> {{ movie.release_year }}</p>
                <p><strong>Genre:</strong> {{ movie.genre }}</p>
                <p><strong>Director:</strong> {{ movie.director.name }}</p>
                <p><strong>Synopsis:</strong> {{ movie.synopsis }}</p>
    
                {% if average_rating %}
                    <p><strong>Average Rating:</strong> {{ average_rating|floatformat:1 }}/5</p>
                {% else %}
                    <p>No ratings yet.</p>
                {% endif %}
    
                <h3>Reviews:</h3>
                {% if reviews %}
                    <ul>
                        {% for review in reviews %}
                            <li>
                                <p><strong>{{ review.user.name }}</strong> ({{ review.review_date|date:"F j, Y" }}):</p>
                                <p>{{ review.review_text }}</p>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p>No reviews yet.</p>
                {% endif %}
            </div>
        </div>
    
        <!-- Form to add review and rating -->
        {% if not user_review or not user_rating %}
        <div class="row mt-5">
            <div class="col-md-12">
                <h4>Add Your Review and Rating</h4>
                <form method="post" action="{% url 'movie_detail' movie.id %}">
                    {% csrf_token %}
                    {% if not user_review %}
                    <div class="form-group mb-3">
                        <label for="review_text">Your Review:</label>
                        <textarea name="review_text" id="review_text" class="form-control" rows="4"></textarea>
                    </div>
                    {% endif %}
    
                    {% if not user_rating %}
                    <div class="form-group mb-3">
                        <label for="rating">Your Rating:</label>
                        <div class="rating">
                            {% for i in "12345" %}
                            <label>
                                <input type="radio" name="rating" value="{{ i }}"> {{ i }} Stars
                            </label>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
    
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>
        </div>
        {% endif %}
    </div>
  </main>
  <div style="height: 100px; width: 100%;">
    <!-- Your content goes here -->
</div>
<footer id="footer" class="footer dark-background">



  <div class="copyright text-center">
    <div class="container d-flex flex-column flex-lg-row justify-content-center justify-content-lg-between align-items-center">

      <div class="d-flex flex-column align-items-center align-items-lg-start">
        <div>
          Â© Copyright <strong><span>CriticCircle</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
          <p>A108 Adam Street</p>
            <p>New York, NY 535022</p>
        </div>
      </div>

      <div class="social-links order-first order-lg-last mb-3 mb-lg-0">
        <a href=""><i class="bi bi-twitter-x"></i></a>
        <a href=""><i class="bi bi-facebook"></i></a>
        <a href=""><i class="bi bi-instagram"></i></a>
        <a href=""><i class="bi bi-linkedin"></i></a>
      </div>

    </div>
  </div>

</footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'assets/vendor/php-email-form/validate.js' %}"></script>
  <script src="{% static 'assets/vendor/aos/aos.js' %}"></script>
  <script src="{% static 'assets/vendor/glightbox/js/glightbox.min.js' %}"></script>
  <script src="{% static 'assets/vendor/swiper/swiper-bundle.min.js' %}"></script>

  <!-- Main JS File -->
  <script src="{% static 'assets/js/main.js' %}"></script>

</body>

</html>
